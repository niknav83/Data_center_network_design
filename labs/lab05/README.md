### VxLAN. EVPN L2.

## Цель:

- Настроить Overlay на основе VxLAN EVPN для L2 связанности между клиентами


## В этой самостоятельной работе мы ожидаем, что вы самостоятельно:
  
1. Настроить Overlay на основе VxLAN EVPN для L2 связанности между клиентами


### Описание/Пошаговая инструкция выполнения домашнего задания:

- В качестве Underlay-сети для IP-связанности будем использовать eBGP. Настройка eBGP проводилась в [предыдущей](https://github.com/niknav83/Data_center_network_design/tree/main/labs/lab04) лабораторной работе
- Настроить eBGP peering в Address Family L2VPN EVPN, указать BGP-соседство с IP-адресами Loopback 0 соседних устройств
- Выбрать VNI и VLAN ID. Создать VLAN и связать его с VNI на всех LEAF-коммутаторах
- Создать интерфейсы Loopback 10 на LEAF-коммутаторах и задать им IP-адреса
- Создать и настроить интерфейсы VxLAN на всех LEAF-коммутаторах - NVE
- Прописать VLAN на физических интерфейсах в Access Mode, к которым подключены клиентские устройства
- Выполнить проверку работы EVPN и VxLAN на всех устройствах

## Схема стенда 
![img_1.png](img_1.PNG)

## Таблица адресов

| Device  | Interface | IP Address   | Subnet Mask     | Default Gateway |
|---------|-----------|--------------|-----------------|-----------------|
| Spine 1 | lo 0      | 192.168.0.1  | 255.255.255.255 |                 |
|         | E1/1      | 192.168.1.0  | 255.255.255.254 |                 |
|         | E1/2      | 192.168.1.20 | 255.255.255.254 |                 |
|         | E1/3      | 192.168.1.30 | 255.255.255.254 |                 |
| Spine 1 | lo 0      | 192.168.0.2  | 255.255.255.255 |                 |
|         | E1/1      | 192.168.2.0  | 255.255.255.254 |                 |
|         | E1/2      | 192.168.2.20 | 255.255.255.254 |                 |
|         | E1/3      | 192.168.2.30 | 255.255.255.254 |                 |
| Leaf 1  | lo 0      | 192.168.0.11 | 255.255.255.255 |                 |
|         | lo 10     | 192.168.0.111| 255.255.255.255 |                 |
|         | E1/1      | 192.168.1.1  | 255.255.255.254 |                 |
|         | E1/2      | 192.168.2.1  | 255.255.255.254 |                 |
|         | E1/3      | 192.168.10.1 | 255.255.255.0   |                 |
| Leaf 2  | lo 0      | 192.168.0.12 | 255.255.255.255 |                 |
|         | lo 10     | 192.168.0.112| 255.255.255.255 |                 |
|         | E1/1      | 192.168.1.21 | 255.255.255.254 |                 |
|         | E1/2      | 192.168.2.21 | 255.255.255.254 |                 |
|         | E1/3      | 192.168.20.1 | 255.255.255.0   |                 |
| Leaf 3  | lo 0      | 192.168.0.13 | 255.255.255.255 |                 |
|         | lo 10     | 192.168.0.113| 255.255.255.255 |                 |
|         | E1/1      | 192.168.1.31 | 255.255.255.254 |                 |
|         | E1/2      | 192.168.2.31 | 255.255.255.254 |                 |
|         | E1/3      | 192.168.30.1 | 255.255.255.0   |                 |
|         | E1/4      | 192.168.40.1 | 255.255.255.0   |                 |
| VPC1    | eth0      | 192.168.10.1 | 255.255.255.0   |                 |
| VPC2    | eth0      | 192.168.20.1 | 255.255.255.0   |                 |
| VPC3    | eth0      | 192.168.10.2 | 255.255.255.0   |                 |
| VPC4    | eth0      | 192.168.20.2 | 255.255.255.0   |                 |


### [Файлы конфигураций устройст и сама работа выполненная в EVE-NG ](https://github.com/niknav83/Data_center_network_design/tree/main/labs/lab05/configs)

В данной работе применялса образ nxosv9k-9500-9.3.8

Логин и пароль: admin 

## Приступаем к настрйке сети:

### Настроим интерфейсы и IP адреса на всех устройствах Underlay-сети.

<details>

<summary> Конфигурация интерфейсов для Spine-1: </summary>

```


```
</details>


<details>

<summary> Конфигурация интерфейсов для Spine-2: </summary>

```


```
</details>


<details>

<summary> Конфигурация интерфейсов для Leaf-1: </summary>

```


```
</details>


<details>

<summary> Конфигурация интерфейсов для Leaf-2: </summary>

```


```
</details>


<details>

<summary> Конфигурация интерфейсов для Leaf-3: </summary>

```


```
</details>




### Далее для общей связанности между всеми устройствами настроим протокол BGP.

На Nexus необходимо для начала включить функцию BGP

```
feature bgp
```

Конфигурация BGP для Spine-1:

```


```

 Конфигурация BGP для Spine-2:

```


```

 Конфигурация BGP для Leaf-1:

```


```

 Конфигурация BGP для Leaf-2:

```


```

 Конфигурация BGP для Leaf-3:

```


```

## Проверяем работу протокола BGP:


<details>
  
<summary>Вывод команды show ip bgp summary:</summary>

Spine-1

```


```

Spine-2

```


```

Leaf-1

```


```

Leaf-2

```


```

Leaf-3

```



```


```

Spine-2

```


```

Leaf-1

```


```

Leaf-2

```


```

Leaf-3

```


```

</details>


